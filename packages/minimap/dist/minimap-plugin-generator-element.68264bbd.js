function e(e){return e&&e.__esModule?e.default:e}var t=require("fs-plus"),i=require("path"),a=require("atom"),s=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire7d67;s.register("7DGKC",(function(n,o){function r(){const e=document.createElement(h);return e.createdCallback(),e}function l(e,t){c(atom.packages.getApmPath(),["install"],t,{cwd:e})}function c(e,t,i,s={}){return new a.BufferedProcess({command:e,args:t,exit:i,options:s})}Object.defineProperty(n.exports,"createMinimapPluginGeneratorElement",{get:()=>r,set:void 0,enumerable:!0,configurable:!0});var d=s("bNORb"),m=s("9jcTZ");const h="minimap-plugin-generator";class g extends HTMLElement{static initClass(){this.registerCommands(),m.default(this,h)}static registerCommands(){atom.commands.add("minimap-plugin-generator",{"core:confirm"(){this.confirm()},"core:cancel"(){this.detach()}})}createdCallback(){this.previouslyFocusedElement=null,this.mode=null,this.modal=document.createElement("atom-panel"),this.modal.classList.add("minimap-plugin-generator"),this.modal.classList.add("modal"),this.modal.classList.add("overlay"),this.modal.classList.add("from-top"),this.editor=atom.workspace.buildTextEditor({mini:!0}),this.editorElement=atom.views.getView(this.editor),this.error=document.createElement("div"),this.error.classList.add("error"),this.message=document.createElement("div"),this.message.classList.add("message"),this.modal.appendChild(this.editorElement),this.modal.appendChild(this.error),this.modal.appendChild(this.message),this.appendChild(this.modal)}connectedCallback(){this.previouslyFocusedElement=document.activeElement,this.message.textContent="Enter plugin path",this.setPathText("my-minimap-plugin"),this.editorElement.focus()}attach(){atom.views.getView(atom.workspace).appendChild(this)}setPathText(a,s){s||(s=[0,a.length]);const n=atom.config.get("core.projectHome")||process.env.ATOM_REPOS_HOME||e(i).join(t.getHomeDirectory(),"github");this.editor.setText(e(i).join(n,a));const o=this.editor.getText().length-a.length;this.editor.setSelectedBufferRange([[0,o+s[0]],[0,o+s[1]]])}detach(){this.parentNode&&(this.previouslyFocusedElement&&this.previouslyFocusedElement.focus(),this.parentNode.removeChild(this))}confirm(){this.validPackagePath()&&(this.removeChild(this.modal),this.message.innerHTML=`\n        <span class='loading loading-spinner-tiny inline-block'></span>\n        Generate plugin at <span class="text-primary">${this.getPackagePath()}</span>\n      `,this.createPackageFiles((()=>{const e=this.getPackagePath();atom.open({pathsToOpen:[e],devMode:atom.config.get("minimap.createPluginInDevMode")}),this.message.innerHTML='<span class="text-success">Plugin successfully generated, opening it now...</span>',setTimeout((()=>{this.detach()}),2e3)})))}getPackagePath(){const t=this.editor.getText(),a=d.dasherize(e(i).basename(t));return e(i).join(e(i).dirname(t),a)}validPackagePath(){return!t.existsSync(this.getPackagePath())||(this.error.textContent=`Path already exists at '${this.getPackagePath()}'`,this.error.style.display="block",!1)}initPackage(t,a){const s=e(i).resolve(__dirname,e(i).join("..","templates","plugin-"+this.template));c(atom.packages.getApmPath(),["init","-p",""+t,"--template",s],a)}createPackageFiles(t){const a=this.getPackagePath();(t=>{const a=e(i).join(atom.getConfigDirPath(),"packages",e(i).sep);if(0===t.indexOf(a))return!0;const s=e(i).join(atom.getConfigDirPath(),"dev","packages",e(i).sep);return 0===t.indexOf(s)})(a)?this.initPackage(a,(()=>{l(a,t)})):this.initPackage(a,(()=>{((e,t)=>{const i=["link"];atom.config.get("minimap.createPluginInDevMode")&&i.push("--dev"),i.push(""+e),c(atom.packages.getApmPath(),i,t)})(a,(()=>{l(a,t)}))}))}}g.initClass()}));
//# sourceMappingURL=minimap-plugin-generator-element.68264bbd.js.map
